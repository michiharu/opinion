---
slug: unix-philosophy
title: UNIX哲学に学ぶシンプル
authors: [michiharu]
tags: [dev, simple, kiss]
---

シンプルさについて語るときに僕の語ること、というテーマでいくつかの記事を書きました。
今日から毎日、シェアしていこうと思います。

- **UNIX哲学に学ぶシンプル**
- Less is More
- 状態 > 結合 > 複雑性 > コード量
- アプリケーションコードをシンプルに
- N対Nより1対1
- 共通化の条件

書き始める前に春樹さんの次の言葉を思い出しました。
> 説明しなくてはそれがわからんというのは、つまり、どれだけ説明してもわからんということだ

説明しても分からないかもしれないけど、とにかく私の考えるシンプルについてちゃんと言葉にしたいと思います。

## UNIX哲学に学ぶシンプル

実際にWikiを読んでみることをお勧めしますが、
[UNIX哲学](https://ja.wikipedia.org/wiki/UNIX%E5%93%B2%E5%AD%A6)には深くうなづけるたくさんの格言があります。

シンプルさこそが重要であるという考え方は、UNIXの哲学として浸透しています。
そのUNIX哲学でシンプルさを評価している言葉やシンプルさを実現するための方法論をここで紹介します。

### シンプルさについて触れている格言

Wikiには異なる人が同じ意味の言葉を挙げていますが、まとめることはせずにそのまま列挙しました。

- それぞれのプログラムが1つのことをうまくこなすように
  - 新しい仕事をするために、新しい「機能」を追加して古いプログラムを複雑にするのではなく、
    新しいプログラムを構築する
- 一つのことをうまくやるプログラムを書く
- プログラムを書いたり、テストしたり、実行したりするのが簡単に行えるように
- スマートなデータを使うつまらないコードを書け
- 小さいものは美しい
- 各プログラムが一つのことをうまくやるようにせよ
- 効率よりも移植しやすさを選べ
- ソフトウェアを梃子(てこ)として利用せよ
- 拘束的なユーザーインターフェースは作るな

### より悪いことは、より良いことだ （Worse is better）

リチャード・P・ガブリエルは、UNIXの重要な優位性のひとつは彼が「より悪いことは、より良いことだ」（"Worse is better"）という用語に込める
デザイン哲学を体現しているところにあると述べています。

>
「より悪いことは、より良いことだ」式のデザイン・スタイルでは、インターフェースと実装の両面がシンプルであることが、
システムにおける他のいかなる特性よりも重視される――正確さ、堅牢さ、完全さよりも、である。

### レイモンド: UNIXプログラミングの技法

エリック・S・レイモンドは著書『The Art of UNIX Programming』[6]の中で、
UNIX哲学を "**Keep it Simple, Stupid**" （KISS原則、「シンプルでつまらないものに保て」）という、
広く使われている工学哲学として要約しました。

そしてレイモンドは、彼がいかにこの総体的な哲学がUNIXの文化的規範として適用されていると信じているか述べています。

- **モジュール化のルール** クリーンなインターフェースで接続されるシンプルなパーツを書け
  - プログラムは、単純な部品同士を、しっかり目の定義を持つインターフェースでつなぎ合わせたものとして書かれるべきです。
    そうすれば、問題は局所的なものとなり、プログラムの一部は将来のバージョンで新機能をサポートするために交換することができます。
  - このルールの狙いは、複雑で長くて読めないコードをデバッグする時間を節約することにあります。
- **明瞭さのルール** 明瞭さは独創性よりも良い
  - 開発者が最も意志疎通を図るべき相手はコンピュータではなく、プログラムを読み、保守を行う自分を含めた開発者であるかのようにプログラムを書くべきです。
  - このルールは、将来そのコードを扱う人にとって、コードが読みやすく、理解しやすいものにすることを目的としています。
- **分割のルール** ポリシーをメカニズムから分離せよ、インターフェースをエンジンから分離せよ
  - 開発者は、プログラムのメカニズムとプログラムのポリシーを分離する必要があります。
    一つの方法として、プログラムをフロントエンドのインターフェースと、そのインターフェースが通信するバックエンドのエンジンに分ける等があります。
  - このルールは、メカニズムを崩さずにポリシーを変更できるようにし、結果的にバグの数を減らすことを目的としています。
  - 分割ルールはUIライブラリーを使った開発において、テーマシステムによるコンポーネントとスタイルの分割にも同様に適用できます。
- **シンプルさのルール** シンプルさを求めてデザインせよ
  - シンプルさを求めてデザインせよ、複雑にしなければならない場合に限り、複雑さを加えよ。
  - 開発者はシンプルなデザインを心掛けるべきです。プログラムを小さく分かりやすい協調性を持ったピースに分割する方法を模索してください。
  - このルールは、開発者が「緻密（ちみつ）で美しく複雑な」実際にはバグだらけのプログラムを書いてしまうことを防ぐためのものです。
- **倹約のルール** 大きなプログラムを書くのは、他に何もできないことが実証された場合のみ
  - 開発者は大きなプログラムを書くことを避けるべきです。
  - 失敗もしくは妥協的アプローチへの開発時間の過剰投資を防ぐことが、このルールの目的です。
    これらは膨大な作業の数々を破棄したくないというプログラム所有者の気持ちが原因でおこります。
    小さなプログラムは、最適化やメンテナンスが容易であるだけでなく、廃棄する際も削除が容易です。
- **透明性のルール** 透明性を求めてデザインせよ 調査とデバッグが簡単になる
  - 開発者は、将来そのプロジェクトに参加する開発者が、自分の思考プロセスを明瞭に見ることができるように書き、
    有効な入力と正しい出力を容易に識別できる入出力形式を使用することによって、可視性と発見性を設計する必要があります。
  - このルールにより、デバッグにかかる時間を短縮し、プログラムの寿命を延ばすことを目的としています。
- **頑丈さのルール** 頑丈さは透明性とシンプルさから生まれる
  - 開発者は、透明性と発見力を高める設計をすることで、堅牢なプログラムを設計する必要があります。
    なぜなら、理解しやすいコードは、複雑なプログラムでは予見できないような予期せぬ状況に対してストレステストを行いやすいからです。
  - このルールは、開発者が堅牢で信頼性の高い製品を構築できるようにすることを目的としています。
- **代表のルール** 知識をデータに織り込め
  - 知識をデータに織り込め。するとプログラムのロジックをつまらなくて頑丈なものにできる。
  - 開発者は、選択に迫られたとき、プログラムの手続き的なロジックよりも、データをより複雑にすることを選択すべきです。
    なぜなら、人間にとって複雑なデータは、複雑なロジックに比べて理解しやすいからです。
    - 「データを複雑に」という表現は誤解を生むかもしれないので補足します。<br></br>
      例えばユーザーの情報を、`{ "info": "1,36" }`というデータで表現しているとします。
      1は男性（1は女性）、36が年齢を意味しているとしましょう。`{ info: string }`という構造はシンプルですね。<br></br>
      しかし、その代わりに`{ "sex": "man", "age": 36 }`というより複雑なデータ構造を使うことにより、
      そのデータを扱うプログラムをシンプルにすることが出来る、ということだと解釈してください。
  - このルールは、プロジェクトに携わるどの開発者にとってもプログラムを読みやすくすることで、プログラムの保守を可能にすることを目的としています。
- **沈黙のルール** 余計な出力をすべきではない 他の開発者にとってただ邪魔なだけである
  - 開発者は、不要な出力をしないようにプログラムを設計する必要があります。
  - このルールは、他のプログラムや開発者が、冗長な出力を解析することなく、プログラムの出力から必要な情報を選び出せるようにすることを目的としています。
- **修復のルール** 失敗しなければならないときは、騒がしく、かつできるだけ早く失敗せよ
  - 開発者は、故障の原因が特定しやすく、診断しやすい、つまり「音を立てて故障する」プログラムを設計する必要があります。
  - このルールは、プログラムからの不正な出力が入力となり、他のコードの出力が検出されずに破損することを防ぐことを目的としています。
- **生成のルール** hand-hackingは避けよ
  - プログラムを書けるときに、プログラムを書くためにプログラムを書け。
  - 開発者は手書きでコードを書くことを避け、代わりに抽象的な高水準プログラムを書いて、コードを生成する必要があります。
  - このルールは、ヒューマンエラーを減らし、時間を節約することを目的としています。

## まとめ

UNIX哲学においてシンプルこそが最も重要だと考えられていますが、
シンプルに開発するためのたくさんのヒントがUNIX哲学には含まれています。

今日このブログを読んで１つだけ、お気に入りの格言を見つけて覚えてもらえたらと思います。
