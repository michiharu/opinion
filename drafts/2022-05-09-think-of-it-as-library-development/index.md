---
slug: think-of-it-as-library-development
title: 共通化の条件
authors: [michiharu]
tags: [dev, simple, kiss]
---

シンプルさについて語るときに僕の語ること、というテーマでいくつか記事を書きたいと思います。

今回は、共通化処理を作る前に考えて欲しいことについてです。

## 共通化の条件

同じような処理を記述している場合に、処理を共通化出来ないかと考えるのは自然なことだと思います。
しかし、共通化したためにコードが複雑になるケースもあります。
共通化はシンプルさを破壊する危険があるということを十分に認識しておく必要があります。
共通化する前に何を目的とした共通化であるか、しっかり整理しましょう。

例えば安易な覚悟で処理を共通化させ、その共通化コードを使っていてバグが見つかった状況を想像してください。

残念なことにその共通化コードにはテストもドキュメントもありません。
あなたが共通化コードを書いたのでない場合、まず共通化コードの使い方を間違えている可能性を考えて共通化コードを熟読します。
共通化のために抽象的に書かれた共通化コードを理解するのは、共通化されていないコードを読むよりも大変です。

さらに悪いことに、共有化コードの内部のバグであることが特定できました。
このバグを修正するには、当然そのコードに依存するすべてのコードに注意を払いながら修正方法を検討しなくてはいけないかもしれません。

そのような開発体験は最悪で、最初から書き直したい気持ちになります。

処理を共通化を検討するために私が考えた必須条件は次の通りです。

- 共通化対象である「1つのこと」を、きちんと言語化できるか
- 共通処理の実装を完成させるだけでなく、テストとドキュメントを充実させるコストを払う価値があるか

最初の条件をクリアしている場合、大抵は第２の条件がほとんどハードルになりません。
最初の条件をクリアしていない場合はテストやドキュメントが充実している場合でも、コードの可読性を下げてしまう恐れがあります。
つまり共通化によってコードが短くなっているとしてもシンプルさを失っており、それを利用するためのコードを書くためにたくさんの時間を必要とします。

すべてのコードはシンプルさが追求されるべきだと考えますが、
共通化されるコードは他から依存されないコードよりも、シンプルさについてより注意を向けておく必要があります。

## まとめ

アプリケーション開発のためのライブラリーは数多く生み出されていますが、
もし目的に叶うライブラリーを探してみてもない場合には、共通化するメリットの少ない課題かもしれません。

またフロントのコードは開発が進みユーザーからのフィードバックが集まるにつれてUIの個別化が進みます。
そのようなアプリケーションの成長も考慮して慎重に共通化したいところですね。
